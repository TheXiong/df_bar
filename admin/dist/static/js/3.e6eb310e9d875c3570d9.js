webpackJsonp([3],{aMzS:function(e,t){},tVh0:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={name:"articleList",data:function(){return{total:0,page:1,limit:10,search:"",sort:null,userListData:[],roleVisible:!1,roleForm:{level:""},roleFormRules:{level:[{required:!0,message:"请选择角色",trigger:"blur"}]},roleList:this.$store.getters.roleList,editRow:null,integralVisible:!1,integralForm:{integral:""},integralFormRules:{integral:[{required:!0,message:"请填写积分变动值",trigger:"blur"},{validator:function(e,t,l){/^(\-?)\d+$/.test(t)?0!=t?l():l(new Error("变化值不能为0")):l(new Error("请输入数字"))},trigger:"blur"}]}}},methods:{handleEditRole:function(e,t){var l=this;this.roleForm={level:""},this.editRow=t,this.roleVisible=!0,this.$nextTick(function(){l.$refs.roleForm.clearValidate()})},handleEditIntegral:function(e,t){var l=this;this.integralForm={integral:""},this.editRow=t,this.integralVisible=!0,this.$nextTick(function(){l.$refs.integralForm.clearValidate()})},roleSubmit:function(){var e=this;this.$refs.roleForm.validate(function(t){if(t){var l={level:e.roleForm.level,user_id:e.editRow.id};e.$axios.post("/a/set_manager",l).then(function(t){e.$message({showClose:!0,message:"操作成功",type:"success"}),e.getList(),e.roleVisible=!1}).catch(function(e){console.log(e)})}})},integralSubmit:function(){var e=this;this.$refs.integralForm.validate(function(t){if(t){var l={integral:e.integralForm.integral,user_id:e.editRow.id};e.$axios.post("/a/gift_points",l).then(function(t){e.$message({showClose:!0,message:"操作成功",type:"success"}),e.getList(),e.integralVisible=!1}).catch(function(e){console.log(e)})}})},currentChange:function(e){this.page=e,this.getList()},getList:function(){var e=this,t={page:this.page,limit:this.limit,search:this.search};this.$axios.post("/a/user_list",t).then(function(t){e.userListData=t.data.data.users,e.total=t.data.data.count}).catch(function(e){console.log(e)})},switchChange:function(e,t){var l=this,i={status:e,user_id:t};this.$axios.post("/a/update_user_status",i).then(function(e){l.$message({showClose:!0,message:"操作成功",type:"success"}),l.getList()}).catch(function(e){console.log(e)})},query:function(){this.getList()},reset:function(){this.search="",this.getList()}},mounted:function(){this.getList()}},r={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("div",[l("el-form",{attrs:{inline:""}},[l("el-form-item",{attrs:{label:"搜索用户"}},[l("el-input",{attrs:{type:"text",autocomplete:"off",placeholder:"用户id或电话"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),l("el-form-item",[l("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")]),e._v(" "),l("el-button",{on:{click:e.reset}},[e._v("重置")])],1)],1)],1),e._v(" "),l("el-table",{attrs:{data:e.userListData}},[l("el-table-column",{attrs:{prop:"id",label:"ID"}}),e._v(" "),l("el-table-column",{attrs:{prop:"name",label:"用户名"}}),e._v(" "),l("el-table-column",{attrs:{prop:"mobile",label:"电话"}}),e._v(" "),l("el-table-column",{attrs:{prop:"integral",label:"积分"}}),e._v(" "),l("el-table-column",{attrs:{prop:"level_name",label:"角色"}}),e._v(" "),l("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-switch",{attrs:{"active-value":-1,"inactive-value":0,"active-text":"冻结","inactive-text":"正常"},on:{change:function(l){return e.switchChange(l,t.row.id)}},model:{value:t.row.status,callback:function(l){e.$set(t.row,"status",l)},expression:"scope.row.status"}})]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"join_time",label:"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatTimestamp")(t.row.join_time)))]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{size:"mini"},on:{click:function(l){e.handleEditRole(t.$index,t.row)}}},[e._v("设置角色")]),e._v(" "),l("el-button",{attrs:{size:"mini"},on:{click:function(l){e.handleEditIntegral(t.$index,t.row)}}},[e._v("更改积分")])]}}])})],1),e._v(" "),l("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total},on:{"current-change":e.currentChange,"prev-click":e.currentChange,"next-click":e.currentChange}}),e._v(" "),l("el-dialog",{attrs:{title:"设置角色",visible:e.roleVisible,width:"30%"},on:{"update:visible":function(t){e.roleVisible=t}}},[l("el-form",{ref:"roleForm",attrs:{model:e.roleForm,rules:e.roleFormRules}},[l("el-form-item",{attrs:{label:"角色",prop:"level"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.roleForm.level,callback:function(t){e.$set(e.roleForm,"level",t)},expression:"roleForm.level"}},e._l(e.roleList,function(e){return l("el-option",{key:e.level,attrs:{label:e.level_cnname,value:e.level}})}))],1)],1),e._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.roleVisible=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:e.roleSubmit}},[e._v("确 定")])],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"更改积分",visible:e.integralVisible,width:"30%"},on:{"update:visible":function(t){e.integralVisible=t}}},[l("el-form",{ref:"integralForm",attrs:{model:e.integralForm,rules:e.integralFormRules}},[l("el-form-item",{attrs:{label:"变化值",prop:"integral"}},[l("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.integralForm.integral,callback:function(t){e.$set(e.integralForm,"integral",t)},expression:"integralForm.integral"}})],1)],1),e._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.integralVisible=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:e.integralSubmit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var o=l("VU/8")(i,r,!1,function(e){l("aMzS")},"data-v-6a0c7162",null);t.default=o.exports}});
//# sourceMappingURL=3.e6eb310e9d875c3570d9.js.map